2+2
library(tidymodels)
library(tidyverse)
library(lubridate)
library(httr)
library(jsonlite)
library(tidymodels)
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("lubridate")
install.packages("httr")
install.packages("tidyverse")
library(tidyverse)
library(lubridate)
library(httr)
library(jsonlite)
library(tidymodels)
r_insp <- GET("https://opendata.arcgis.com/datasets/ebe3ae7f76954fad81411612d7c4fb17_1.geojson")
inspections <- content(r_insp, "text") %>%
fromJSON() %>%
.$features %>%
.$properties %>%
as_tibble()
inspections_clean <- inspections %>%
mutate(date = ymd_hms(DATE_) %>% as.Date()) %>%
select(-c(DATE_, DESCRIPTION, OBJECTID))
restauraunts <- content(r_rest, "text") %>%
fromJSON() %>%
.$features %>%
.$properties %>%
as_tibble() %>%
select(-OBJECTID)
restauraunts <- restauraunts %>%
mutate(RESTAURANTOPENDATE = ymd_hms(RESTAURANTOPENDATE) %>% as.Date())
r_rest <- GET("https://opendata.arcgis.com/datasets/124c2187da8c41c59bde04fa67eb2872_0.geojson") #json
restauraunts <- content(r_rest, "text") %>%
fromJSON() %>%
.$features %>%
.$properties %>%
as_tibble() %>%
select(-OBJECTID)
restauraunts <- restauraunts %>%
mutate(RESTAURANTOPENDATE = ymd_hms(RESTAURANTOPENDATE) %>% as.Date())
inspections_restaurants <- inspections_clean %>%
left_join(restauraunts, by = c("HSISID", "PERMITID")) %>%
filter(SCORE > 50, FACILITYTYPE == "Restaurant") %>%
distinct(HSISID, date, .keep_all = TRUE) %>%
select(-c(FACILITYTYPE, PERMITID)) %>%
select(-c(NAME, contains("ADDRESS"), CITY, STATE, POSTALCODE, PHONENUMBER, X, Y, GEOCODESTATUS))
inspections_restaurants %>%
glimpse()
data_time_feats <- inspections_restaurants %>%
arrange(date) %>%
mutate(SCORE_yr_overall = slider::slide_index_dbl(SCORE,
.i = date,
.f = mean,
na.rm = TRUE,
.before = lubridate::days(365),
.after = -lubridate::days(1))
) %>%
group_by(HSISID) %>%
mutate(SCORE_lag = lag(SCORE),
SCORE_recent = slider::slide_index_dbl(SCORE,
date,
mean,
na.rm = TRUE,
.before = lubridate::days(365*3),
.after = -lubridate::days(1),
.complete = FALSE),
days_since_open = (date - RESTAURANTOPENDATE) / ddays(1),
days_since_last = (date - lag(date)) / ddays(1)) %>%
ungroup() %>%
arrange(date)
library(slider)
install.packages("slider")
library(slider)
library(slider)
data_time_feats <- inspections_restaurants %>%
arrange(date) %>%
mutate(SCORE_yr_overall = slider::slide_index_dbl(SCORE,
.i = date,
.f = mean,
na.rm = TRUE,
.before = lubridate::days(365),
.after = -lubridate::days(1))
) %>%
group_by(HSISID) %>%
mutate(SCORE_lag = lag(SCORE),
SCORE_recent = slider::slide_index_dbl(SCORE,
date,
mean,
na.rm = TRUE,
.before = lubridate::days(365*3),
.after = -lubridate::days(1),
.complete = FALSE),
days_since_open = (date - RESTAURANTOPENDATE) / ddays(1),
days_since_last = (date - lag(date)) / ddays(1)) %>%
ungroup() %>%
arrange(date)
data_time_feats
install.packages("tm")
library(shiny); runApp('Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health/drug_mh_shiny_app.R')
runApp('Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health/drug_mh_shiny_app.R')
runApp('Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health/application')
runApp('Downloads/YMseekA-overnight-visualization-feature-Sai-31009751 4/Iteration-1/Visualization/Dashboard/1.5')
runApp('Downloads/YMseekA-overnight-visualization-feature-Sai-31009751 4/Iteration-1/Visualization/Dashboard/1.5')
install.packages("conflicted")
runApp('Downloads/YMseekA-overnight-visualization-feature-Sai-31009751 4/Iteration-1/Visualization/Dashboard/1.5')
runApp('Downloads/YMseekA-overnight-visualization-feature-Sai-31009751 4/Iteration-1/Visualization/Dashboard/1.5')
options(encoding = "UTF-8")
runApp('Downloads/YMseekA-overnight-visualization-feature-Sai-31009751 4/Iteration-1/Visualization/Dashboard/1.5')
options(encoding = "UTF-8")
deployApp()
options(encoding = "UTF-8")
deployApp
deployApp()
runApp('Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health/drug_mh_shiny_app.R')
runApp('Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health/drug_mh_shiny_app.R')
runApp('Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health/drug_mh_shiny_app.R')
runApp('Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health/application')
runApp('Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health/drug_mh_shiny_app.R')
runApp('Downloads/visualisation project/data/Visual1.R')
runApp('Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health/drug_mh_shiny_app.R')
library(shiny); runApp('Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health/drug_mh_shiny_app.R')
runApp('Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health/drug_mh_shiny_app.R')
source_to_obtain_drugs = read.xlsx("Medicare-subsidised-mental-health-specific-services-tables.xlsx", sheetName = "Table MBS.27", startRow = 5, endRow = 603, header = TRUE)
library(xlsx)
source_to_obtain_drugs = read.xlsx("Medicare-subsidised-mental-health-specific-services-tables.xlsx", sheetName = "Table MBS.27", startRow = 5, endRow = 603, header = TRUE)
setwd('/Users/uditarora/Documents/GitHub/YMseekA/Iteration-1/Visualization/MentalHealthServices')
library(xlsx)
source_to_obtain_drugs = read.xlsx("Medicare-subsidised-mental-health-specific-services-tables.xlsx", sheetName = "Table MBS.27", startRow = 5, endRow = 603, header = TRUE)
source_to_obtain_drugs
mental_health_provider_types[mental_health_provider_types$Age.group=="18–24 years"]
mental_health_provider_types = read.xlsx("Medicare-subsidised-mental-health-specific-services-tables.xlsx", sheetName = "Table MBS.27", startRow = 5, endRow = 603, header = TRUE)
mental_health_provider_types[mental_health_provider_types$Age.group=="18–24 years"]
mental_health_provider_types[,mental_health_provider_types$Age.group=="18–24 years"]
mental_health_provider_types[[mental_health_provider_types$Age.group=="18–24 years"]]
mental_health_provider_types[mental_health_provider_types$Age.group == "18–24 years"]
mental_health_provider_types[mental_health_provider_types$Age.group == "18–24 years"]
mental_health_provider_types[mental_health_provider_types$Age.group == "18–24 years"]
mental_health_provider_types[mental_health_provider_types$Age.group == "18–24 years"]
mental_health_provider_types[which(mental_health_provider_types$Age.group == "18–24 years"),]
subset[mental_health_provider_types, Age.group == "18–24 years"]
mental_health_provider_types
subset(mental_health_provider_types, Age.group == "18–24 years")
subset(mental_health_provider_types, Age.group == "18–24 years")
View(source_to_obtain_drugs)
mental_health_provider_types$Age.group
mental_health_provider_types[which(mental_health_provider_types$Age.group =="18–24 years")]
age <- mental_health_provider_types[which(mental_health_provider_types$Age.group =="18–24 years")]
age
View(age)
View(age)
age <- as.data.frame(mental_health_provider_types[which(mental_health_provider_types$Age.group =="18–24 years")])
View(age)
age <- subset(mental_health_provider_types, Age.group == "18–24 years")
View(age)
View(source_to_obtain_drugs)
library(dplyr)
View(mental_health_provider_types)
filter(mental_health_provider_types, Age.group == "18–24 years")
mental_health_provider_types
View(mental_health_provider_types)
mental_health_provider_types %>% filter(Age.group == "18–24 years")
type(mental_health_provider_types)
typeof(mental_health_provider_types)
mental_health_provider_types = as.data.frame(read.xlsx("Medicare-subsidised-mental-health-specific-services-tables.xlsx", sheetName = "Table MBS.27", startRow = 5, endRow = 603, header = TRUE))
typeof(mental_health_provider_types)
mental_health_provider_types =read.xlsx("Medicare-subsidised-mental-health-specific-services-tables.xlsx", sheetName = "Table MBS.27", startRow = 5, endRow = 603, header = TRUE, as.data.frame = TRUE)
mental_health_provider_types
typeof(mental_health_provider_types)
mental_health_provider_types = read.xlsx2("Medicare-subsidised-mental-health-specific-services-tables.xlsx", sheetName = "Table MBS.27", startRow = 5, endRow = 603, header = TRUE, as.data.frame = TRUE)
mental_health_provider_types
typeof(mental_health_provider_types)
m <- as.data.frame(gsub("[*#]", "", as.matrix(mental_health_provider_types)))
typeof(m)
mental_health_provider_types = read.xlsx("Medicare-subsidised-mental-health-specific-services-tables.xlsx", sheetName = "Table MBS.27", startRow = 5, endRow = 603, header = TRUE, as.data.frame = TRUE)
typeof(mental_health_provider_types)
as.matrix(mental_health_provider_types)
as.data.frame(as.matrix(mental_health_provider_types))
typeof(x)
x = as.data.frame(as.matrix(mental_health_provider_types))
typeof(x)
do.call(rbind.data.frame, mental_health_provider_types)
(rbind.data.frame, mental_health_provider_types)
rbind.data.frame(mental_health_provider_types)
x = rbind.data.frame(mental_health_provider_types)
typeof(x)
x$Age.group
mental_health_provider_types$Age.group
mental_health_provider_types$Age.group == "18–24 years"
mental_health_provider_types$Age.group == "18–24 years"
mental_health_provider_types$Age.group %like% "%18"
mental_health_provider_types$Age.group %like% "^18"
mental_health_provider_types[Age.group %like% "^18"]
grep("^18", mental_health_provider_types$Age.group)
mental_health_provider_types
names(mental_health_provider_types)
mental_health_provider_types[, ~c('Quarter', 'Average.annual..change..per.cent...2015.16.to.2019.20')]
mental_health_provider_types[, c('Provider.type', 'Sex', 'Age.group', 'X2015.16', 'X2016.17', 'X2017.18', 'X2018.19', 'X2019.20')]
mental_health_provider_sel_col[which(mental_health_provider_sel_col$Sex == "Female"), ]
mental_health_provider_sel_col = mental_health_provider_types[, c('Provider.type', 'Sex', 'Age.group', 'X2015.16', 'X2016.17', 'X2017.18', 'X2018.19', 'X2019.20')]
mental_health_provider_sel_col[which(mental_health_provider_sel_col$Sex == "Female"), ]
mental_health_provider_sel_col[which(mental_health_provider_sel_col$Age.group == "18–24 years"), ]
mental_health_provider_sel_col[172,]
mental_health_provider_sel_col[172, "Age.group"]
mental_health_provider_sel_col[which(mental_health_provider_sel_col$Age.group == "18–24 years"), ]
mental_health_provider_sel_col[which(mental_health_provider_sel_col$Age.group %like% "18"), ]
mental_health_provider_sel_col[which(grepl("18", mental_health_provider_sel_col$Age.group)), ]
mental_health_provider_sel_col[which(grepl("18", mental_health_provider_sel_col$Age.group)), ] %>% group_by('Provider.type', 'Sex')
mental_health_provider_sel_col[which(grepl("18", mental_health_provider_sel_col$Age.group)), ] %>% group_by(Provider.type, Sex)
aggregate(cbind(x$X2015.16, x$X2016.17, x$X2017.18, x$X2018.19, x$X2019.20), by=list(x$Provider.type, x$Sex), FUN=sum)
x = mental_health_provider_sel_col[which(grepl("18", mental_health_provider_sel_col$Age.group)), ]
aggregate(cbind(x$X2015.16, x$X2016.17, x$X2017.18, x$X2018.19, x$X2019.20), by=list(x$Provider.type, x$Sex), FUN=sum)
aggregate(cbind(x$X2015.16, x$X2016.17, x$X2017.18, x$X2018.19, x$X2019.20), by=list(x$Provider.type, x$Sex), sum)
aggregate(cbind(as.numeric(x$X2015.16), as.numeric(x$X2016.17), as.numeric(x$X2017.18), as.numeric(x$X2018.19), as.numeric(x$X2019.20)), by=list(x$Provider.type, x$Sex), sum)
names(mental_health_grouped) <- c('Provider_type', 'Sex', '2015-2016','2016-2017','2017-2018','2018-2019','2019-2020')
library(xlsx)
library(dplyr)
mental_health_provider_types = read.xlsx("Medicare-subsidised-mental-health-specific-services-tables.xlsx", sheetName = "Table MBS.27", startRow = 5, endRow = 603, header = TRUE ,as.data.frame = TRUE)
mental_health_provider_sel_col = mental_health_provider_types[, c('Provider.type', 'Sex', 'Age.group', 'X2015.16', 'X2016.17', 'X2017.18', 'X2018.19', 'X2019.20')]
mental_health_age_provider_data = mental_health_provider_sel_col[which(grepl("18", mental_health_provider_sel_col$Age.group)), ]
mental_health_grouped = aggregate(cbind(as.numeric(mental_health_age_provider_data$X2015.16), as.numeric(mental_health_age_provider_data$X2016.17), as.numeric(mental_health_age_provider_data$X2017.18), as.numeric(mental_health_age_provider_data$X2018.19), as.numeric(mental_health_age_provider_data$X2019.20)), by=list(mental_health_age_provider_data$Provider.type, mental_health_age_provider_data$Sex), sum)
names(mental_health_grouped) <- c('Provider_type', 'Sex', '2015-2016','2016-2017','2017-2018','2018-2019','2019-2020')
mental_health_grouped
write.csv(mental_health_grouped, "mental_health_sex_provider_type.csv")
write.csv(mental_health_grouped, "mental_health_sex_provider_type.xlsx")
write.xlsx(mental_health_grouped, "mental_health_sex_provider_type.xlsx")
####2
service_areas = read.xlsx("Medicare-subsidised-mental-health-specific-services-tables.xlsx", sheetName = "Table MBS.2", startRow = 5, endRow = 142, header = TRUE ,as.data.frame = TRUE)
service_areas
reduce_service_areas = service_areas[which(grepl("Age group", service_areas$Provider.type)), ]
reduce_service_areas
service_areas
reduce_service_areas = service_areas[which(grepl("Age group", service_areas$Patient.demographics)), ]
reduce_service_areas
service_areas$Patient.demographics
reduce_service_areas = service_areas[which(service_areas$Patient.demographics == "Age group"), ]
reduce_service_areas
reduce_service_areas = service_areas[which(grepl("Remoteness", service_areas$Patient.demographics)), ]
reduce_service_areas
reduce_service_areas = service_areas[which(grepl("Remoteness", service_areas$Patient.demographics)), c('Provider.Type', 'Patient.demographic.characteristics', 'Number.of.patients')]
reduce_service_providers_areas = reduce_service_areas[ , c('Provider.Type', 'Patient.demographic.characteristics', 'Number.of.patients')]
reduce_service_providers_areas = reduce_service_areas[, c('Provider.type', 'Patient.demographic.characteristics', 'Number.of.patients')]
reduce_service_providers_areas
write.xlsx(reduce_service_providers_areas, "reduce_service_providers_areas.xlsx")
reduce_service_providers_areas$Number.of.patients = as.numeric(reduce_service_providers_areas$Number.of.patients)
write.xlsx(reduce_service_providers_areas, "reduce_service_providers_areas.xlsx")
reduce_service_providers_areas
reduce_service_providers_areas$Number.of.patients = as.numeric(reduce_service_providers_areas$Number.of.patients)
write.xlsx(reduce_service_providers_areas, "reduce_service_providers_areas.xlsx")
reduce_service_providers_areas
service_areas <- as.data.frame(gsub("\,", "", as.matrix(service_areas)))
service_areas <- as.data.frame(gsub("/,", "", as.matrix(service_areas)))
service_areas
service_areas <- as.data.frame(gsub("/.", "", as.matrix(service_areas)))
service_areas
service_areas = read.xlsx("Medicare-subsidised-mental-health-specific-services-tables.xlsx", sheetName = "Table MBS.2", startRow = 5, endRow = 142, header = TRUE ,as.data.frame = TRUE)
reduce_service_areas = service_areas[which(grepl("Remoteness", service_areas$Patient.demographics)), ]
reduce_service_providers_areas = reduce_service_areas[, c('Provider.type', 'Patient.demographic.characteristics', 'Number.of.patients')]
reduce_service_providers_areas <- as.data.frame(gsub("/.", "", as.matrix(reduce_service_providers_areas)))
reduce_service_providers_areas$Number.of.patients = as.numeric(reduce_service_providers_areas$Number.of.patients)
reduce_service_providers_areas
reduce_service_providers_areas$Number.of.patients = as.numeric(round(reduce_service_providers_areas$Number.of.patients))
reduce_service_providers_areas
write.xlsx(reduce_service_providers_areas, "reduce_service_providers_areas.xlsx")
service_areas = read.xlsx("Medicare-subsidised-mental-health-specific-services-tables.xlsx", sheetName = "Table MBS.2", startRow = 5, endRow = 142, header = TRUE ,as.data.frame = TRUE)
reduce_service_areas = service_areas[which(grepl("Remoteness", service_areas$Patient.demographics)), ]
reduce_service_providers_areas = reduce_service_areas[, c('Provider.type', 'Patient.demographic.characteristics', 'Number.of.patients')]
reduce_service_providers_areas$Number.of.patients = as.numeric(round(reduce_service_providers_areas$Number.of.patients))
write.xlsx(reduce_service_providers_areas, "reduce_service_providers_areas.xlsx")
reduce_service_providers_areas$Number.of.patients = round(as.numeric(reduce_service_providers_areas$Number.of.patients))
service_areas = read.xlsx("Medicare-subsidised-mental-health-specific-services-tables.xlsx", sheetName = "Table MBS.2", startRow = 5, endRow = 142, header = TRUE ,as.data.frame = TRUE)
reduce_service_areas = service_areas[which(grepl("Remoteness", service_areas$Patient.demographics)), ]
reduce_service_providers_areas = reduce_service_areas[, c('Provider.type', 'Patient.demographic.characteristics', 'Number.of.patients')]
reduce_service_providers_areas$Number.of.patients = round(as.numeric(reduce_service_providers_areas$Number.of.patients))
write.xlsx(reduce_service_providers_areas, "reduce_service_providers_areas.xlsx")
reduce_service_providers_areas
setwd("/Users/uditarora/Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health")
library(shiny); runApp('alc_consumption.R')
runApp('alc_consumption.R')
runApp('alc_consumption.R')
runApp('alc_consumption.R')
runApp('drug_mh_shiny_app.R')
runApp('alc_consumption.R')
runApp('alc_consumption.R')
runApp('presc_drugs.R')
runApp('alc_consumption.R')
runApp('drug_mh_shiny_app.R')
runApp('illicit_Drugs.R')
runApp('alc_consumption.R')
runApp('alc_consumption.R')
runApp('alcohol_deployment/alc_consumption.R')
setwd("/Users/uditarora/Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health/alcohol_deployment")
runApp()
runApp()
runApp('~/Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health/presc_drugs_deployment')
runApp('~/Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health/illicit_drugs_deployment')
runApp('~/Documents/GitHub/YMseekA/Iteration-1/Visualization/Drugs_mental_health/illicit_drugs_deployment')
